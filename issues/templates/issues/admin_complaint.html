{% extends 'issues/base.html' %}
{% block content %}
<!-- added: back button -->
<a href="javascript:history.back()" class="btn btn-sm btn-outline-secondary mb-3">‚Üê Back</a>

<div class="d-flex justify-content-between align-items-center mb-3">
<h3 class="h5 mb-0">All complaints</h3>
<form class="d-flex" method="get">
<input class="form-control me-2" name="q" placeholder="Search..." value="{{ request.GET.q }}">
<select class="form-select me-2" name="priority">
<option value="">All Priorities</option>
<option value="high">High</option>
<option value="medium">Medium</option>
<option value="low">Low</option>
</select>
<select class="form-select me-2" name="status">
<option value="">All Statuses</option>
<option value="open">Open</option>
<option value="in_progress">In Progress</option>
<option value="resolved">Resolved</option>
<option value="closed">Closed</option>
</select>
<button class="btn btn-primary">Filter</button>
</form>
</div>


<div class="card shadow-sm">
<div class="table-responsive">
<table class="table table-hover align-middle mb-0">
<thead class="table-light">
<tr>
<th>ID</th>
<th>Title</th>
<th>Reporter</th>
<th>Priority</th>
<th>Status</th>
<th>Created</th>
<th></th>
</tr>
</thead>
<tbody>
{% for c in complaints %}
<tr>
<td>{{ c.id }}</td>
<td class="fw-semibold">{{ c.title }}</td>
<td>{{ c.reporter.username }}</td>
<td>
<span class="badge {% if c.priority=='high' %}bg-danger{% elif c.priority=='medium' %}bg-warning text-dark{% else %}bg-secondary{% endif %}">{{ c.get_priority_display }}</span>
</td>
<td>
<span class="badge {% if c.status=='open' %}bg-primary{% elif c.status=='in_progress' %}bg-info text-dark{% elif c.status=='resolved' %}bg-success{% else %}bg-dark{% endif %}">{{ c.get_status_display }}</span>
</td>
<td class="small text-muted">{{ c.created_at|date:'M d, Y' }}</td>
<td><a class="btn btn-sm btn-outline-primary" href="{% url 'issues:admin_update_complaint' c.pk %}">Manage</a></td>
</tr>
{% empty %}
<tr><td colspan="7" class="text-center text-muted">No complaints found.</td></tr>
{% endfor %}
</tbody>
</table>
</div>
</div>
{% endblock %}
